<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <!-- <script src="../../node_modules/underscore/underscore.js" ></script> -->
    <script src="./underscore.js" ></script>
    <script>
        _.mixin({
            addOne: function(num) {
                console.log(num + 1);
                return [1,2,3]
            }
        });
        var addOneResult = _(2).chain().addOne(); // 3
        console.log('addOneResult', addOneResult);
        console.log('addOneResult.push(666', addOneResult.myPush(666))
        // console.log('--------------');
        var part1 = _.chain([1, 2, 3]);
        console.log('part1', part1);
        var part2 = part1.myPush(4);
        // var part2 = part1.first();
        // var part2 = part1.reverse();
        // console.log('part11111', part1);
        // console.log('part2222', part2);
        // var part3 = part2.value();
        // var part4 = _.chain([1, 2, 3]).chain();
        // var part4 = _([1, 2, 3]).chain();
        // console.log('part4', part4);

        // var part5 = part4.reverse();
        // console.log('part5', part5);


        // (function () {

        //     var root = (typeof self == 'object' && self.self == self && self) ||
        //         (typeof global == 'object' && global.global == global && global) ||
        //         this || {};

        //     var ArrayProto = Array.prototype;

        //     var push = ArrayProto.push;

        //     var _ = function (obj) {
        //         if (obj instanceof _) return obj;
        //         if (!(this instanceof _)) return new _(obj);
        //         this._wrapped = obj;
        //     };

        //     if (typeof exports != 'undefined' && !exports.nodeType) {
        //         if (typeof module != 'undefined' && !module.nodeType && module.exports) {
        //             exports = module.exports = _;
        //         }
        //         exports._ = _;
        //     } else {
        //         root._ = _;
        //     }

        //     _.VERSION = '0.2';

        //     var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;

        //     var isArrayLike = function (collection) {
        //         var length = collection.length;
        //         return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;
        //     };

        //     _.each = function (obj, callback) {
        //         var length, i = 0;

        //         if (isArrayLike(obj)) {
        //             length = obj.length;
        //             for (; i < length; i++) {
        //                 if (callback.call(obj[i], obj[i], i) === false) {
        //                     break;
        //                 }
        //             }
        //         } else {
        //             for (i in obj) {
        //                 if (callback.call(obj[i], obj[i], i) === false) {
        //                     break;
        //                 }
        //             }
        //         }

        //         return obj;
        //     }

        //     _.isFunction = function (obj) {
        //         return typeof obj == 'function' || false;
        //     };

        //     _.functions = function (obj) {
        //         var names = [];
        //         for (var key in obj) {
        //             if (_.isFunction(obj[key])) names.push(key);
        //         }
        //         return names.sort();
        //     };

        //     /**
        //      * 在 _.mixin(_) 前添加自己定义的方法
        //      */
        //     _.reverse = function (string) {
        //         return string.split('').reverse().join('');
        //     }

        //     _.chain = function (obj) {
        //         var instance = _(obj);
        //         instance._chain = true;
        //         console.log('instance', instance);
        //         return instance;
        //     };

        //     var chainResult = function (instance, obj) {
        //         // return instance._chain ? _(obj).chain() : obj;
        //         var res = _(obj);
        //         console.log('res', res);
        //         return instance._chain ? _(obj).chain() : obj;
        //     };
        //     _.push = function(item) {
        //         // this.push(item);
        //         console.log('this', this);
        //         debugger
        //         this._wrapped.push(item);
        //         // return chainResult(this, this._wrapped);
        //     }
        //     _.mixin = function (obj) {
        //         _.each(_.functions(obj), function (name) {
        //             var func = _[name] = obj[name];
        //             _.prototype[name] = function () {
        //                 debugger
        //                 var args = [this._wrapped];
        //                 push.apply(args, arguments);
        //                 return chainResult(this, func.apply(_, args));
        //                 // return chainResult(this, func.apply(this, args));
        //             };
        //         });
        //         return _;
        //     };

        //     _.mixin(_);

        //     _.prototype.value = function () {
        //         return this._wrapped;
        //     };

        // })()
        // console.log(_.chain([1]));
        // console.dir(_.push);
        // _.chain([1]).push(2).logb().push(3).logb()
        // var res2 = _.chain([1]).map((item) => {
        //     console.log('item', item);
        //     return 111
        // })
        // console.log('res2', res2);
        // console.log('res2.first()', res2.first());;
        // res2.map(item => {
        //     console.log('item222', item);
        // })
        // push(2).logb()
        // _.chain().push(2).logb()
    </script>
</body>

</html>